(this["webpackJsonpissuer-react"]=this["webpackJsonpissuer-react"]||[]).push([[0],{171:function(e,t,a){e.exports=a(327)},176:function(e,t,a){},177:function(e,t,a){},179:function(e,t,a){},183:function(e,t,a){},185:function(e,t,a){},232:function(e,t,a){},233:function(e,t,a){},260:function(e,t,a){},261:function(e,t,a){},262:function(e,t,a){},3:function(e,t){var a="https://issuer.api.staging.didi.atixlabs.com/api/1.0/didi_issuer";e.exports={VERSION:"0.1.0",API_ROUTES:{LOGIN:a+"/user/login",TEMPLATES:{GET_ALL:a+"/template/all",GET_QR:function(e,t){return a+"/template/"+e+"/qr/"+t},REQUEST:function(e){return a+"/template/request/"+e},GET:function(e){return a+"/template/"+e},CREATE:a+"/template/",EDIT:function(e){return a+"/template/"+e},DELETE:function(e){return a+"/template/"+e}},PARTICIPANTS:{POST_NEW:a+"/participant/new/",GET_GLOBAL:a+"/participant/global/",GET_ALL:function(e){return a+"/participant/all/"+e},GET_NEW:function(e){return a+"/participant/new/"+e},GET:function(e){return a+"/participant/"+e},GET_DIDS:a+"/participant/dids"},CERTIFICATES:{CREATE:a+"/cert",EDIT:function(e){return a+"/cert/"+e},EMMIT:function(e){return a+"/cert/"+e+"/emmit"},GET_ALL:a+"/cert/all",GET:function(e){return a+"/cert/"+e},DELETE:function(e){return a+"/cert/"+e}},DELEGATE:{CREATE:a+"/delegate",DELETE:a+"/delegate",GET_ALL:a+"/delegate/all",GET_NAME:a+"/delegate/name",CHANGE_NAME:a+"/delegate/name"}},ROUTES:{LOGIN:"/login",DELEGATES:"/admin",QR_REQUEST:"/qr_request",LIST:"/list",TEMPLATES:"/templates",EDIT_TEMPLATE:"/templates/edit/",CERTIFICATES:"/certificates",EDIT_CERT:"/certificates/edit/"},CERT_FIELD_MANDATORY:{DID:"DID",NAME:"CERTIFICADO O CURSO",FIRST_NAME:"NOMBRE",LAST_NAME:"APELLIDO",EXPIRATION_DATE:"EXPIRATION DATE"},DELEGATES:{ICONS:{ADD_BUTTON:"add_box"},TABLE:{PAGE_SIZE:10,MIN_ROWS:3}},TEMPLATES:{PREVIEW_ELEMS_LENGTH:{1:2,2:4,3:6,4:6},ICONS:{ADD_BUTTON:"add_box",OK:"check_circle_outline",MISSING:"highlight_off"},TABLE:{PAGE_SIZE:10,MIN_ROWS:3},EDIT:{BOOLEAN:{TRUE:"Si",FALSE:"No"},ICONS:{REQUIRED:"check_circle_outline",NOT_REQUIRED:"radio_button_unchecked",ADD_OPTION:"add_circle_outline",REMOVE_OPTION:"clear",DELETE:"cancel_presentation"},TYPING_TIMEOUT:1e3},CATEGORIES:["EDUCACION","FINANZAS","VIVIENDA","IDENTIDAD","BENEFICIOS","LABORAL"],TYPES:{TEXT:"Text",PARAGRAPH:"Paragraph",DATE:"Date",NUMBER:"Number",BOOLEAN:"Boolean",CHECKBOX:"Checkbox"},TYPE_MAPPING:{Email:"Email",Telefono:"Phone",Dni:"dni",Nacionalidad:"nationality",Nombres:"names",NOMBRE:"names",Apellidos:"lastNames",APELLIDO:"lastNames",Direccion:"streetAddress",Calle:"numberStreet",Piso:"floor",Departamento:"department","Codigo Zip":"zipCode",Pais:"country"},SHARED_TYPES:{Email:"Email",Telefono:"Telefono",Dni:"Dni",Nacionalidad:"Nacionalidad",Nombres:"Nombres",Apellidos:"Apellidos",Direccion:"Direccion",Calle:"Calle",Piso:"Piso",Departamento:"Departamento","Codigo Zip":"Codigo Zip",Pais:"Pais"},DATA_TYPES:{CERT:"cert",OTHERS:"others",PARTICIPANT:"participant"},MANDATORY_DATA:{DID:"DID",FULL_NAME:"NOMBRE COMPLETO",PARTICIPANT_FIRST_NAME:"NOMBRE",PARTICIPANT_LAST_NAME:"APELLIDO",NAME:"CERTIFICADO O CURSO"}},CERTIFICATES:{ERR:{INVALID_DID:"El DID ingresado es incorrecto o mal formado.",CSV_REQUIRED_VALUE_INVALID:function(e){return{err:"CSV_REQUIRED_VALUE_INVALID",message:"CSV inv\xe1lido, el campo "+e+" contiene un valor incorrecto"}},CSV_REQUIRED_VALUE_MISSING:function(e){return{err:"CSV_REQUIRED_VALUE_MISSING",message:"CSV inv\xe1lido, el campo "+e+" es obligatorio"}},MISSING_FIELD:function(e){return{err:"REQUIRED_VALUE_MISSING",message:"El campo "+e+" es obligatorio"}},CSV_MISSING_FIELDS:function(){return{err:"CSV_MISSING_FIELDS",message:"La cantidad de campos en el csv no se corresponde con la del certificado."}},EXP_DATE_INVALID:{err:"EXP_DATE_INVALID",message:"La fecha de expiracion debe ser mayor a la fecha actual."}},MANDATORY_DATA:{DID:"DID",FIRST_NAME:"NOMBRE",LAST_NAME:"APELLIDO"},EDIT:{PARTICIPANT_SELECT:"SELECCIONAR PARTICIPANTE",SPLIT:"GENERAR MICROCREDENCIALES",TEMPLATE_SELECT:"CERTIFICADO O CURSO"},TABLE:{PAGE_SIZE:10,MIN_ROWS:3},REQUEST_TYPES:{mail:"Email",tel:"Phone",personal:"Datos Personales",address:"Domicilio Legal"}}}},320:function(e,t,a){e.exports=a.p+"static/media/1.6df6277c.png"},321:function(e,t,a){e.exports=a.p+"static/media/2.5751f83d.png"},322:function(e,t,a){e.exports=a.p+"static/media/3.6b7baf83.png"},323:function(e,t,a){},327:function(e,t,a){"use strict";a.r(t);var n,r,i=a(0),o=a.n(i),c=a(25),l=a.n(c),s=(a(176),a(12)),u=a(11),E=a(21),d=a(22),m=a(23),T=a(100),p=a(20),f=(a(177),a(3)),S=a.n(f),A=a(14),D=a.n(A),v=a(28),I=a(18),g=(a(179),a(16)),C=a.n(g),h=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"login",value:function(e,t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,password:t})};fetch(S.a.API_ROUTES.LOGIN,r).then((function(e){return e.json()})).then((function(e){if("success"===e.status){var t=e.data.token;return a(t)}n(e.data)})).catch((function(e){return n(e)}))}}]),e}(),O=a(5),R=a.n(O),L=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).onLogin=function(e){e.preventDefault();var t=Object(I.a)(a);h.login(a.state.name,a.state.password,function(){var e=Object(v.a)(D.a.mark((function e(a){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.a.set("token",a),t.setState({});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){t.setState({error:e}),console.log(e)}))},a.updateName=function(e){a.setState({name:e.target.value,error:""})},a.updatePass=function(e){a.setState({password:e.target.value,error:""})},a.state={name:"",password:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return C.a.get("token")?o.a.createElement(p.a,{to:S.a.ROUTES.LIST}):o.a.createElement("div",{className:"Login"},o.a.createElement("div",{className:"LeftContent"},o.a.createElement("h1",{className:"BackgroundText"},R.a.LOGIN.WELCOME),o.a.createElement("form",{onSubmit:this.onLogin},o.a.createElement("input",{className:"LoginInput",type:"text",onChange:this.updateName}),o.a.createElement("input",{className:"LoginInput",type:"password",onChange:this.updatePass,autoComplete:"on"}),o.a.createElement("button",{className:"LoginButton",type:"submit",value:"Submit"},R.a.LOGIN.BUTTONS.ENTER)),o.a.createElement("div",{className:"errMsg"},this.state.error&&this.state.error.message)),o.a.createElement("div",{className:"RightContent"},o.a.createElement("p",null,"Prueba")))}}]),t}(i.Component),N=Object(p.g)(L),P=(a(183),a(45)),_=(a(184),a(185),a(54)),b=(a(85),a(151)),y=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"render",value:function(e){return o.a.createElement(b.ClipLoader,{css:"z-index: 1; height: 100px; width: 100px; position: absolute; left: 50%; margin-left: -50px; top: 50%; margin-top: -50px;",size:100,loading:e})}}]),e}(),M=a(380),k=a(372),j=a(381),B=a(371),F=a(368),U=a(367),G=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).cleanData=function(){for(var e=a.state.fields,t=0,n=Object.keys(a.state.fields);t<n.length;t++){e[n[t]]=""}a.setState({fields:e})},a.open=function(){a.cleanData(),a.setState({isOpen:!0})},a.close=function(){a.cleanData(),a.setState({isOpen:!1})},a.updateField=function(e,t){var n=a.state.fields;n[e]=t,a.setState({fields:n})},a.render=function(){var e=a.props.title,t=a.props.onAccept,n=a.props.fieldNames;return o.a.createElement(j.a,{open:a.state.isOpen,onClose:a.close,"aria-labelledby":"form-dialog-title"},o.a.createElement(U.a,{id:"DialogTitle"},e),o.a.createElement(F.a,null,n.length&&n.map((function(e,t){return o.a.createElement(M.a,{key:"field-"+t,autoFocus:!0,margin:"dense",id:e,label:e,type:"text",onChange:function(t){a.updateField(e,t.target.value)},fullWidth:!0})}))),o.a.createElement(B.a,null,o.a.createElement(k.a,{onClick:a.close,color:"primary"},R.a.LIST.DIALOG.CANCEL),o.a.createElement(k.a,{onClick:function(){t(a.state.fields),a.close()},disabled:Object.values(a.state.fields).indexOf("")>=0,color:"primary"},R.a.LIST.DIALOG.CREATE)))};var n={};return a.props.fieldNames.forEach((function(e){return n[e]=""})),a.state={isOpen:!1,fields:n},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}}]),t}(i.Component),w=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).open=function(){a.setState({isOpen:!0})},a.close=function(){a.setState({isOpen:!1})},a.render=function(){var e=a.props.title,t=a.props.message,n=a.props.confirm,r=a.props.onAccept,i=a.props.hideClose;return o.a.createElement(j.a,{open:a.state.isOpen,onClose:a.close,"aria-labelledby":"form-dialog-title"},o.a.createElement(U.a,{id:"DialogTitle"},e),o.a.createElement(F.a,null,o.a.createElement("div",null,t)),o.a.createElement(B.a,null,!i&&o.a.createElement(k.a,{onClick:a.close,color:"primary"},R.a.LIST.DIALOG.CANCEL),o.a.createElement(k.a,{onClick:function(){r&&r(),a.close()},color:"primary"},n)))},a.state={isOpen:!1},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}}]),t}(i.Component),x=a(32),V=a.n(x),q=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).openDeleteDialog=function(){a.deleteDialog&&a.deleteDialog.open()},a.renderCreateDialog=function(){return o.a.createElement(G,{onRef:function(e){return a.createDialog=e},title:R.a.LIST.DIALOG.CREATE_TEMPLATE_TITLE,fieldNames:["name"],onAccept:a.props.onCreate})},a.renderDeleteDialog=function(){return o.a.createElement(w,{onRef:function(e){return a.deleteDialog=e},title:R.a.LIST.DIALOG.DELETE_TEMPLATE_TITLE,message:R.a.LIST.DIALOG.DELETE_CONFIRMATION,confirm:R.a.LIST.DIALOG.DELETE,onAccept:a.props.onDelete})},a.renderSectionButtons=function(e){var t=a.props.selected;return o.a.createElement("div",{className:"HeadButtons"},t&&o.a.createElement("button",{className:"CreateButton TemplateCreateButton",disabled:e,onClick:function(){a.createDialog&&a.createDialog.open()}},o.a.createElement(V.a,{icon:S.a.TEMPLATES.ICONS.ADD_BUTTON}),o.a.createElement("div",{className:"CreateButtonText TemplateCreateText"},R.a.LIST.BUTTONS.CREATE_TEMPLATE)))},a.renderTable=function(){var e=a.props.templates,t=a.props.columns?a.props.columns:[];return o.a.createElement("div",{className:"TemplateTable"},o.a.createElement(_.a,{sortable:!1,previousText:R.a.LIST.TABLE.PREV,nextText:R.a.LIST.TABLE.NEXT,data:e,columns:t,defaultPageSize:S.a.TEMPLATES.TABLE.PAGE_SIZE,minRows:S.a.TEMPLATES.TABLE.MIN_ROWS}))},a.state={},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"render",value:function(){var e=this.props.error||this.state.error,t=this.props.loading;return o.a.createElement("div",{className:t?"Templates Loading":"Templates"},y.render(t),this.renderSectionButtons(t),this.renderDeleteDialog(),this.renderCreateDialog(),this.renderTable(),o.a.createElement("div",{className:"errMsg"},e&&e.message))}}]),t}(i.Component),Q=Object(p.g)(q),Y=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getTemplateData",value:function(e,t,a,n){return{_id:e._id,name:e.name,actions:o.a.createElement("div",{className:"Actions"},o.a.createElement("div",{className:"EditAction",onClick:function(){n()||t(e._id)}},R.a.LIST.BUTTONS.EDIT),o.a.createElement("div",{className:"DeleteAction",onClick:function(){n()||a(e._id)}},R.a.LIST.BUTTONS.DELETE))}}},{key:"getTemplateColumns",value:function(){return[{Header:R.a.LIST.TABLE.TEMPLATE,accessor:"name"},{Header:"",accessor:"actions"}]}}]),e}(),H=(a(232),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).onCertificateEdit=function(e){a.props.history.push(S.a.ROUTES.EDIT_CERT+e)},a.onCertificateCreate=function(){a.props.history.push(S.a.ROUTES.EDIT_CERT)},a.openDeleteDialog=function(){a.deleteDialog&&a.deleteDialog.open()},a.openRevokeDialog=function(){a.revokeDialog&&a.revokeDialog.open()},a.renderDeleteDialog=function(){return o.a.createElement(w,{onRef:function(e){return a.deleteDialog=e},title:R.a.LIST.DIALOG.DELETE_CERT_TITLE,message:R.a.LIST.DIALOG.DELETE_CONFIRMATION,confirm:R.a.LIST.DIALOG.DELETE,onAccept:a.props.onDelete})},a.renderRevocationDialog=function(){return o.a.createElement(w,{onRef:function(e){return a.revokeDialog=e},title:R.a.LIST.DIALOG.REVOKE_CERT_TITLE,message:R.a.LIST.DIALOG.REVOKE_CONFIRMATION,confirm:R.a.LIST.DIALOG.REVOKE,onAccept:a.props.onDelete})},a.renderSectionButtons=function(e){var t=a.props.selected;return o.a.createElement("div",{className:"HeadButtons"},t&&o.a.createElement("button",{disabled:e,className:"CreateButton",onClick:a.onCertificateCreate},o.a.createElement(V.a,{icon:S.a.TEMPLATES.ICONS.ADD_BUTTON}),o.a.createElement("div",{className:"CreateButtonText EmmitCertText"},R.a.LIST.BUTTONS.CREATE_CERT)))},a.renderTable=function(){var e=a.props.certificates,t=a.props.columns?a.props.columns:[];return o.a.createElement("div",{className:"CertificateTable"},o.a.createElement(_.a,{sortable:!1,previousText:R.a.LIST.TABLE.PREV,nextText:R.a.LIST.TABLE.NEXT,data:e,columns:t,defaultPageSize:S.a.CERTIFICATES.TABLE.PAGE_SIZE,minRows:S.a.CERTIFICATES.TABLE.MIN_ROWS}))},a.renderButtons=function(e){return o.a.createElement("div",{className:"CertButtons"},o.a.createElement("button",{disabled:e,className:"EmmitSelectedButton",onClick:a.props.onMultiEmmit},R.a.LIST.BUTTONS.EMMIT_SELECTED))},a.state={name:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"render",value:function(){var e=this.props.error||this.state.error,t=this.props.loading;return o.a.createElement("div",{className:t?"Certificates Loading":"Certificates"},y.render(t),this.renderDeleteDialog(),this.renderRevocationDialog(),this.renderSectionButtons(t),this.renderTable(),this.renderButtons(t),o.a.createElement("div",{className:"errMsg"},e&&e.message))}}]),t}(i.Component)),W=Object(p.g)(H),X=a(37),K=a(378),J=a(375),Z=a(382),z=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getCertificatesData",value:function(e,t,a,n,r,i,c,l){var s=e.emmitedOn;return{_id:e._id,certName:e.name,createdOn:s?e.emmitedOn.split("T")[0]:"-",firstName:e.firstName,lastName:e.lastName,select:o.a.createElement("div",{className:"Actions"},!s&&o.a.createElement(K.a,{checked:t[e._id],onChange:function(t,n){l()||a(e._id,n)}})),actions:o.a.createElement("div",{className:"Actions"},!s&&o.a.createElement("div",{className:"EmmitAction",onClick:function(){l()||n(e._id)}},R.a.LIST.BUTTONS.EMMIT),o.a.createElement("div",{className:"EditAction",onClick:function(){l()||r(e._id)}},s?R.a.LIST.BUTTONS.VIEW:R.a.LIST.BUTTONS.EDIT),!e.emmitedOn&&o.a.createElement("div",{className:"DeleteAction",onClick:function(){l()||i(e._id)}},R.a.LIST.BUTTONS.DELETE))}}},{key:"getCertColumns",value:function(e,t,a,n,r,i,c,l,s){var u=Object(X.a)(new Set(e.map((function(e){return e.certName}))));return[{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.LAST_NAME),o.a.createElement("input",{type:"text",className:"TableInputFilter",onChange:l})),accessor:"lastName"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.NAME),o.a.createElement("input",{type:"text",className:"TableInputFilter",onChange:c})),accessor:"firstName"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.CERT),o.a.createElement(J.a,{className:"TableInputFilter Checkbox",onChange:i},o.a.createElement(Z.a,{value:void 0,className:"DataInput"},""),u.map((function(e,t){return o.a.createElement(Z.a,{value:e,key:"cert-option-"+t,className:"DataInput"},e)})))),accessor:"certName"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.EMISSION_DATE),o.a.createElement("div",null,R.a.LIST.TABLE.EMISSION_DATE2)),accessor:"createdOn"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.ACTIONS),o.a.createElement(J.a,{className:"TableInputFilter Checkbox",onChange:r},o.a.createElement(Z.a,{value:void 0,className:"DataInput"},""),o.a.createElement(Z.a,{value:"EMITIDOS",className:"DataInput"},"EMITIDOS"),o.a.createElement(Z.a,{value:"NO EMITIDOS",className:"DataInput"},"NO EMITIDOS"))),accessor:"actions"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.SELECT),o.a.createElement("div",null,"("+Object.values(t).filter((function(e){return e})).length+")"),o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:a,onChange:function(e,t){s()||n(t)}}))),accessor:"select"}]}}]),e}(),$=(a(233),a(92)),ee=a.n($),te=a(376),ae=a(373),ne=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"create",value:function(e,t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({name:t})};fetch(S.a.API_ROUTES.TEMPLATES.CREATE,r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"save",value:function(e,t,a,n){var r={cert:t.data.cert.map((function(e){return{name:e.name,type:e.type,mandatory:e.mandatory,defaultValue:e.defaultValue,required:e.required,options:e.options}})),participant:t.data.participant.map((function(e){return{name:e.name,type:e.type,mandatory:e.mandatory,defaultValue:e.defaultValue,required:e.required,options:e.options}})),others:t.data.others.map((function(e){return{name:e.name,type:e.type,mandatory:e.mandatory,defaultValue:e.defaultValue,required:e.required,options:e.options}}))},i=S.a.API_ROUTES.TEMPLATES.EDIT(t._id),o={method:"PUT",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({data:JSON.stringify(r),preview:t.previewData,category:t.category,type:t.previewType})};fetch(i,o).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getAll",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.TEMPLATES.GET_ALL,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}},{key:"get",value:function(e,t,a,n){var r={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.TEMPLATES.GET(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getQrPetition",value:function(e,t,a,n,r){var i={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.TEMPLATES.GET_QR(t,a),i).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return n(e.data);r(e.data)})).catch((function(e){return r(e)}))}},{key:"sendRequest",value:function(e,t,a,n,r,i){var o={method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({dids:t,certNames:a})};fetch(S.a.API_ROUTES.TEMPLATES.REQUEST(n),o).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return r(e.data);i(e.data)})).catch((function(e){return i(e)}))}},{key:"delete",value:function(e,t,a,n){var r={method:"DELETE",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.TEMPLATES.DELETE(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}}]),e}(),re=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getGlobal",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.PARTICIPANTS.GET_GLOBAL,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}},{key:"getAll",value:function(e,t,a,n){var r={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.PARTICIPANTS.GET_ALL(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"createNew",value:function(e,t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({data:t})};fetch(S.a.API_ROUTES.PARTICIPANTS.POST_NEW,r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getNew",value:function(e,t,a,n){var r={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.PARTICIPANTS.GET_NEW(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"get",value:function(e,t,a,n){var r={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.PARTICIPANTS.GET(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getAllDids",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.PARTICIPANTS.GET_DIDS,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}}]),e}(),ie=a(235),oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).open=function(){a.setState({isOpen:!0})},a.close=function(){a.setState({isOpen:!1})},a.generateQrCode=function(){var e=C.a.get("token"),t=Object(I.a)(a);t.setState({loading:!0,qr:void 0});var n=Math.random().toString(36).slice(-8),r=t.props.template?t.props.template:t.state.selectedTemplate;ne.getQrPetition(e,r._id,n,(function(e){t.setState({requestCode:n,qr:e,participant:void 0,loading:!1,error:!1}),setTimeout((function(){var a=document.getElementById("canvas");a&&(ie.toCanvas(a,e,(function(e){e&&console.error(e)})),t.setState({qrSet:!0}))}),100)}),(function(e){t.setState({loading:!1,error:e}),console.log(e)}))},a.getParticipant=function(){var e=a.state.participant;return e&&a.setState({participant:void 0}),e},a.render=function(){var e=a.props.title,t=a.props.template,n=a.state.loading||a.props.loading;return o.a.createElement("div",null,a.renderQrLoadedDialog(),o.a.createElement(j.a,{className:n?"Loading QrDialog":"QrDialog",open:a.state.isOpen,onClose:a.close,"aria-labelledby":"form-dialog-title"},o.a.createElement(U.a,{id:"DialogTitle"},e),o.a.createElement(F.a,null,y.render(n),o.a.createElement("div",{className:"QrReq"},!t&&a.renderTemplateSelector(),a.renderParticipantSelector(),a.renderQrPetition(),a.renderQrButtons()))))},a.renderQrLoadedDialog=function(){var e=a.state.participant;return o.a.createElement(w,{onRef:function(e){return a.qrLoadedDialog=e},title:R.a.EDIT.DIALOG.QR.LOADED_BY_QR(e?e.name:""),message:"",confirm:R.a.EDIT.BUTTONS.CLOSE,hideClose:!0})},a.renderParticipantSelector=function(){var e=a.props.participants;return o.a.createElement("div",null,e&&e.length>0&&o.a.createElement("div",null,R.a.EDIT.DIALOG.PARTICIPANT.TITLE),e&&e.length>0&&o.a.createElement(J.a,{className:"ParticipantsSelector",multiple:!0,displayEmpty:!0,value:a.state.parts,onChange:function(e){a.setState({parts:e.target.value})},renderValue:function(e){return e.map((function(e){return e.name})).join(", ")}},e.map((function(e,t){return o.a.createElement(Z.a,{key:"ParticipantsSelector-"+t,value:e},o.a.createElement(K.a,{checked:a.state.parts.indexOf(e)>-1}),o.a.createElement(ae.a,{primary:e.name}))}))))},a.renderTemplateSelector=function(){var e=a.props.template,t=a.props.templates;return e||!t?o.a.createElement("div",null):o.a.createElement("div",{className:"QrTemplateSelector"},!a.state.qrSet&&o.a.createElement("div",null,R.a.QR.TEMPLATE_SELECT_MESSAGE),a.state.qrSet&&o.a.createElement("div",null,R.a.QR.QR_MESSAGE),o.a.createElement("div",{className:"DataName"},R.a.QR.TEMPLATE_SELECT),o.a.createElement(te.a,{options:t,getOptionLabel:function(e){return e?e.name:""},value:a.state.selectedTemplate?a.state.selectedTemplate:"",renderInput:function(e){return o.a.createElement(M.a,Object.assign({},e,{variant:"standard",label:"",placeholder:"",fullWidth:!0}))},onChange:function(e,t){a.setState({selectedTemplate:t})}}))},a.renderQrButtons=function(){var e=!a.state.selectedTemplate&&!a.props.template,t=a.props.participants,n=Object(I.a)(a);return o.a.createElement("div",{className:"QrButtons"},o.a.createElement("button",{className:"CloseButton",onClick:n.close},R.a.EDIT.BUTTONS.CANCEL),t&&t.length>0&&o.a.createElement("button",{className:"QrButton",disabled:0===n.state.parts.length,onClick:function(){n.props.onDataReceived&&(n.props.onDataReceived(n.state.parts),n.close())}},R.a.EDIT.DIALOG.PARTICIPANT.CREATE),o.a.createElement("button",{className:"QrButton",disabled:e,onClick:n.generateQrCode},R.a.QR.BUTTONS.GENERATE))},a.state={parts:[],loading:!1,isOpen:!1,qrSet:!1},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this);var e=this;n=setInterval((function(){if(e.state.qrSet){var t=C.a.get("token");re.getNew(t,e.state.requestCode,(function(t){t&&e.state.qrSet&&(e.qrLoadedDialog&&e.qrLoadedDialog.open(),e.close(),e.props.onDataReceived&&e.props.onDataReceived([t]),e.setState({participant:t,qr:void 0,qrSet:!1,isOpen:!1,error:!1}))}),(function(t){e.setState({loading:!1,error:t}),console.log(t)}))}e.state.requestSent&&e.props.onParticipantsReload()}),1e4)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0),n&&clearInterval(n)}},{key:"renderQrPetition",value:function(){return this.state.qr?o.a.createElement("div",{className:"QrPetition"},o.a.createElement("canvas",{id:"canvas"}),o.a.createElement("div",{className:"QR_PD"},R.a.QR.QR_PD)):o.a.createElement("div",null)}}]),t}(i.Component),ce=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).canSendRequest=function(e){if(e)return!1;var t=a.props.participants.map((function(e){return e.did})),n=a.props.selectedParticipants,r=!0,i=!1,o=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)for(var s=c.value,u=0,E=Object.keys(n);u<E.length;u++){if(n[E[u]][s])return!0}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return!1},a.sendRequests=function(){var e=a.props.participants.map((function(e){return e.did})),t=a.props.selectedParticipants,n={},r=!0,i=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)for(var s=c.value,u=0,E=Object.keys(t);u<E.length;u++){var d=E[u];t[d][s]&&(n[s]||(n[s]=[]),n[s].push(S.a.CERTIFICATES.REQUEST_TYPES[d]))}}catch(v){i=!0,o=v}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}for(var m=C.a.get("token"),T=Object(I.a)(a),p=0,f=Object.keys(n);p<f.length;p++){var A=f[p],D=Math.random().toString(36).slice(-8);T.reqSentDialog&&T.reqSentDialog.open(),ne.sendRequest(m,[A],n[A],D,(function(e){T.setState({requestSent:!0})}),(function(e){T.setState({error:e}),console.log(e)}))}},a.createSampleCsv=function(){var e=document.createElement("a"),t=new Blob(["DID(ej:did:eth:0x5f6ed832a5fd0f0a58135f9695ea40af8666db31),NOMBRE(un texto)"],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="sample.csv",document.body.appendChild(e),e.click()},a.LoadDidsFromCsv=function(e){var t=Object(I.a)(a),n=new FileReader;n.onload=function(e){var a=[],r=n.result.split(/[\r\n,]+/),i=2;do{var o=r[i],c=i+1<r.length?r[i+1]:"";o&&c&&a.push({did:o,name:c}),i+=2}while(i<r.length);t.addDids(a)},n.readAsText(e[0])},a.addDids=function(e){var t=C.a.get("token"),n=Object(I.a)(a);a.setState({loading:!0}),re.createNew(t,e,(function(e){var t=n.state.dids,a={},r=!0,i=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;a[s.did]=s.name}}catch(v){i=!0,o=v}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=!0,E=!1,d=void 0;try{for(var m,T=t[Symbol.iterator]();!(u=(m=T.next()).done);u=!0){var p=m.value;a[p.did]=p.name}}catch(v){E=!0,d=v}finally{try{u||null==T.return||T.return()}finally{if(E)throw d}}for(var f=[],S=0,A=Object.keys(a);S<A.length;S++){var D=A[S];f.push({did:D,name:a[D]})}n.props.onReload(),n.setState({loading:!1,dids:f,error:!1})}),(function(e){n.setState({loading:!1,error:e}),console.log(e)}))},a.onBack=function(){a.reqSentDialog&&a.reqSentDialog.close(),a.state.error?a.setState({loading:!1,error:!1}):(a.qrDialog&&a.qrDialog.close(),a.setState({requestSent:!1}),a.componentDidMount())},a.renderQrDialog=function(){return o.a.createElement(oe,{loading:a.state.loading,onRef:function(e){return a.qrDialog=e},title:R.a.EDIT.DIALOG.QR.LOAD_BY_QR,templates:a.props.templates})},a.renderRequestSentDialog=function(){return o.a.createElement(w,{onRef:function(e){return a.reqSentDialog=e},title:R.a.EDIT.DIALOG.QR.REQUEST_SENT,message:"",confirm:R.a.EDIT.BUTTONS.CLOSE,hideClose:!0})},a.renderTable=function(){var e=a.props.participants,t=a.props.columns?a.props.columns:[];return o.a.createElement("div",{className:"ParticipantsTable"},o.a.createElement(_.a,{sortable:!1,previousText:R.a.LIST.TABLE.PREV,nextText:R.a.LIST.TABLE.NEXT,data:e,columns:t,defaultPageSize:S.a.TEMPLATES.TABLE.PAGE_SIZE,minRows:S.a.TEMPLATES.TABLE.MIN_ROWS}))},a.renderButtons=function(e){return o.a.createElement("div",{className:"QrRequestButtons"},o.a.createElement("div",{className:"PartRequestRow"},o.a.createElement("button",{disabled:e,className:"SampleCsv",onClick:a.createSampleCsv},R.a.EDIT.BUTTONS.SAMPLE_PART_FROM_CSV),o.a.createElement(ee.a,{handleFiles:a.LoadDidsFromCsv,fileTypes:".csv"},o.a.createElement("button",{disabled:e,className:"LoadDidsFromCsv"},R.a.EDIT.BUTTONS.LOAD_DIDS_FROM_CSV)),o.a.createElement("button",{className:"QrDialogButton",disabled:e,onClick:function(){a.qrDialog&&a.qrDialog.open()}},R.a.QR.BUTTONS.QR_LOAD)),o.a.createElement("div",{className:"QrButtonsRow"},o.a.createElement("button",{className:"PartRequestButton",disabled:!a.canSendRequest(e),onClick:a.sendRequests},R.a.QR.BUTTONS.REQUEST)))},a.state={loading:!1,requestSent:!1},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillUnmount",value:function(){r&&clearInterval(r)}},{key:"componentDidMount",value:function(){var e=C.a.get("token"),t=this;re.getAllDids(e,(function(e){t.setState({dids:e,error:!1})}),(function(e){t.setState({loading:!1,error:e}),console.log(e)})),r=setInterval((function(){t.state.requestSent&&t.props.onReload()}),1e4)}},{key:"render",value:function(){if(!C.a.get("token"))return o.a.createElement(p.a,{to:S.a.ROUTES.LOGIN});var e=this.props.error||this.state.error,t=this.props.loading||this.state.loading;return o.a.createElement("div",{className:t?"QrReq Loading":"QrReq"},y.render(t),this.renderRequestSentDialog(),this.renderQrDialog(),this.renderTable(),this.renderButtons(t),o.a.createElement("div",{className:"errMsg"},e&&e.message))}}]),t}(i.Component),le=Object(p.g)(ce),se=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getParticipantData",value:function(e,t,a,n){return{did:e.did,name:e.name,tel:o.a.createElement("div",null,e.tel&&o.a.createElement(V.a,{color:"green",icon:S.a.TEMPLATES.ICONS.OK}),!e.tel&&o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.tel[e.did],onChange:function(t,r){n()||a(e.did,"tel",r)}}))),mail:o.a.createElement("div",null,e.mail&&o.a.createElement(V.a,{color:"green",icon:S.a.TEMPLATES.ICONS.OK}),!e.mail&&o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.mail[e.did],onChange:function(t,r){n()||a(e.did,"mail",r)}}))),personal:o.a.createElement("div",null,e.personal&&o.a.createElement(V.a,{color:"green",icon:S.a.TEMPLATES.ICONS.OK}),!e.personal&&o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.personal[e.did],onChange:function(t,r){n()||a(e.did,"personal",r)}}))),address:o.a.createElement("div",null,e.address&&o.a.createElement(V.a,{color:"green",icon:S.a.TEMPLATES.ICONS.OK}),!e.address&&o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.address[e.did],onChange:function(t,r){n()||a(e.did,"address",r)}})))}}},{key:"getParticipantColumns",value:function(e,t,a,n){return[{Header:R.a.LIST.TABLE.NAME,accessor:"name"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.HAS_TEL),o.a.createElement("div",null,"("+Object.values(e.tel).filter((function(e){return e})).length+")"),o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.tel,onChange:function(e,t){n()||a("tel",t)}}))),accessor:"tel"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.HAS_MAIL),o.a.createElement("div",null,"("+Object.values(e.mail).filter((function(e){return e})).length+")"),o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.mail,onChange:function(e,t){n()||a("mail",t)}}))),accessor:"mail"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.HAS_PERSONAL),o.a.createElement("div",null,R.a.LIST.TABLE.HAS_PERSONAL2),o.a.createElement("div",null,"("+Object.values(e.personal).filter((function(e){return e})).length+")"),o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.personal,onChange:function(e,t){n()||a("personal",t)}}))),accessor:"personal"},{Header:o.a.createElement("div",null,o.a.createElement("div",null,R.a.LIST.TABLE.HAS_ADDRESS),o.a.createElement("div",null,"("+Object.values(e.address).filter((function(e){return e})).length+")"),o.a.createElement("div",{className:"Actions"},o.a.createElement(K.a,{checked:t.address,onChange:function(e,t){n()||a("address",t)}}))),accessor:"address"}]}}]),e}(),ue=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"save",value:function(e,t,a,n){var r={cert:t.data.cert.map((function(e){return{name:e.name,value:e.value}})),participant:t.data.participant.map((function(e){return e.map((function(e){return{name:e.name,value:e.value}}))})),others:t.data.others.map((function(e){return{name:e.name,value:e.value}}))},i=t.microCredentials?t.microCredentials:[{title:"certificate data",names:t.data.cert.map((function(e){return e.name}))},{title:"participant data",names:t.data.participant[0].map((function(e){return e.name}))},{title:"others data",names:t.data.others.map((function(e){return e.name}))}],o=t._id?"PUT":"POST",c=t._id?S.a.API_ROUTES.CERTIFICATES.EDIT(t._id):S.a.API_ROUTES.CERTIFICATES.CREATE,l={method:o,headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({templateId:t.templateId,data:JSON.stringify(r),split:t.split,microCredentials:i})};fetch(c,l).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"emmit",value:function(e,t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.CERTIFICATES.EMMIT(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getAll",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.CERTIFICATES.GET_ALL,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}},{key:"get",value:function(e,t,a,n){var r={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.CERTIFICATES.GET(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"delete",value:function(e,t,a,n){var r={method:"DELETE",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.CERTIFICATES.DELETE(t),r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}}]),e}(),Ee=(a(260),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).openDeleteDialog=function(){a.deleteDialog&&a.deleteDialog.open()},a.renderCreateDialog=function(){return o.a.createElement(G,{onRef:function(e){return a.createDialog=e},title:R.a.LIST.DIALOG.CREATE_DELEGATE_TITLE,fieldNames:["name","did"],onAccept:a.props.onCreate})},a.renderDeleteDialog=function(){return o.a.createElement(w,{onRef:function(e){return a.deleteDialog=e},title:R.a.LIST.DIALOG.DELETE_DELEGATE_TITLE,message:R.a.LIST.DIALOG.DELETE_CONFIRMATION,confirm:R.a.LIST.DIALOG.DELETE,onAccept:a.props.onDelete})},a.renderSectionButtons=function(e){var t=a.props.selected;return o.a.createElement("div",{className:"HeadButtons"},t&&o.a.createElement("button",{disabled:e,className:"CreateButton",onClick:function(){a.createDialog&&a.createDialog.open()}},o.a.createElement(V.a,{icon:S.a.DELEGATES.ICONS.ADD_BUTTON}),o.a.createElement("div",{className:"CreateButtonText CreateDelegateText"},R.a.LIST.BUTTONS.CREATE_DELEGATE)))},a.renderTable=function(){var e=a.props.delegates,t=a.props.columns?a.props.columns:[];return o.a.createElement("div",{className:"DelegatesTable"},o.a.createElement(_.a,{sortable:!1,previousText:R.a.LIST.TABLE.PREV,nextText:R.a.LIST.TABLE.NEXT,data:e,columns:t,defaultPageSize:S.a.DELEGATES.TABLE.PAGE_SIZE,minRows:S.a.DELEGATES.TABLE.MIN_ROWS}))},a.state={},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"render",value:function(){if(!C.a.get("token"))return o.a.createElement(p.a,{to:S.a.ROUTES.LOGIN});var e=this.props.error||this.state.error,t=this.props.loading;return o.a.createElement("div",{className:t?"Admin Loading":"Admin"},y.render(t),this.renderCreateDialog(),this.renderDeleteDialog(),this.renderSectionButtons(t),this.renderTable(),o.a.createElement("div",{className:"errMsg"},e&&e.message))}}]),t}(i.Component)),de=Object(p.g)(Ee),me=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getAll",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.DELEGATE.GET_ALL,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}},{key:"create",value:function(e,t,a,n,r){var i={method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({did:t,name:a})};fetch(S.a.API_ROUTES.DELEGATE.CREATE,i).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return n(e.data);r(e.data)})).catch((function(e){return r(e)}))}},{key:"delete",value:function(e,t,a,n){var r={method:"DELETE",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({did:t})};fetch(S.a.API_ROUTES.DELEGATE.DELETE,r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}},{key:"getIssuerName",value:function(e,t,a){var n={method:"GET",headers:{"Content-Type":"application/json",token:e}};fetch(S.a.API_ROUTES.DELEGATE.GET_NAME,n).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return t(e.data);a(e.data)})).catch((function(e){return a(e)}))}},{key:"changeIssuerName",value:function(e,t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify({name:t})};fetch(S.a.API_ROUTES.DELEGATE.CHANGE_NAME,r).then((function(e){return e.json()})).then((function(e){if("success"===e.status)return a(e.data);n(e.data)})).catch((function(e){return n(e)}))}}]),e}(),Te=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getDelegatesData",value:function(e,t,a){return{did:e.did,name:e.name,actions:o.a.createElement("div",{className:"Actions"},o.a.createElement("div",{className:"DeleteAction",onClick:function(){a()||t(e.did)}},R.a.LIST.BUTTONS.DELETE))}}},{key:"getDelegatesColumns",value:function(){return[{Header:R.a.LIST.TABLE.DID,accessor:"did"},{Header:R.a.LIST.TABLE.NAME,accessor:"name"},{Header:"",accessor:"actions"}]}}]),e}(),pe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).onParticipantSelectToggle=function(e,t,n){var r=a.state.allSelectedParticipants,i=a.state.selectedParticipants;i[t][e]=n,a.updateSelectedParticipantsState(a.state.parts,i,r)},a.onParticipantSelectAllToggle=function(e,t){var n=a.state.parts,r=a.state.allSelectedParticipants,i=a.state.selectedParticipants;n.forEach((function(a){a[e]||(i[e][a.did]=t)})),r[e]=t,a.updateSelectedParticipantsState(n,i,r)},a.updateSelectedParticipantsState=function(e,t,n){var r=a.state.partTypes;e.forEach((function(e){r.forEach((function(a){e[a]||t[a][e.did]||(t[a][e.did]=!1)}))})),r.forEach((function(e){n[e]=!0;for(var a=0,r=Object.keys(t[e]);a<r.length;a++){var i=r[a];t[e][i]||(n[e]=!1)}})),a.setState({selectedParticipants:t,allSelectedParticipants:n});var i=e.map((function(e){return se.getParticipantData(e,a.state.selectedParticipants,a.onParticipantSelectToggle,(function(){return a.state.loading}))})),o=se.getParticipantColumns(a.state.selectedParticipants,a.state.allSelectedParticipants,a.onParticipantSelectAllToggle,(function(){return a.state.loading}));a.setState({parts:e,participants:i,participantColumns:o})},a.onParticipantsReload=function(){var e=Object(I.a)(a),t=C.a.get("token");e.setState({loading:!0}),re.getGlobal(t,function(){var t=Object(v.a)(D.a.mark((function t(a){var n,r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.state.allSelectedParticipants,r=e.state.selectedParticipants,e.updateSelectedParticipantsState(a,r,n),e.setState({error:!1,loading:!1});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.setState({loading:!1,error:t}),console.log(t)}))},a.onCertificateRevoke=function(e){a.certificatesSection&&(a.setState({selectedCertId:e}),a.certificatesSection.openRevokeDialog())},a.onCertificateDeleteDialogOpen=function(e){a.certificatesSection&&(a.setState({selectedCertId:e}),a.certificatesSection.openDeleteDialog())},a.onCertificateDelete=function(){var e=a.state.selectedCertId,t=C.a.get("token"),n=Object(I.a)(a),r=n.state.certificates.find((function(t){return t._id===e}));r.actions=o.a.createElement("div",null),r.select=o.a.createElement("div",null),n.setState({certs:n.state.certificates,loading:!0}),ue.delete(t,e,function(){var e=Object(v.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.state.certs.filter((function(e){return e._id!==t._id})),n.setState({certs:a,loading:!1,error:!1}),n.onCertificateSelectAllToggle(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e,loading:!1}),console.log(e)}))},a.onCertificateSelectToggle=function(e,t){var n=a.state.certs,r=a.state.allSelectedCerts,i=a.state.selectedCerts;i[e]=t,a.updateSelectedCertsState(n,i,r)},a.onCertificateSelectAllToggle=function(e){var t=a.state.allSelectedCerts,n=a.state.certs,r=a.state.selectedCerts;n.forEach((function(t){t.emmitedOn||(r[t._id]=e)})),t=e,a.updateSelectedCertsState(n,r,t)},a.updateSelectedCertsState=function(e,t){var n=!0;e.forEach((function(e){e.emmitedOn||t[e._id]||(t[e._id]=!1,n=!1)})),a.setState({selectedCerts:t,allSelectedCerts:n});var r=e.map((function(e){return z.getCertificatesData(e,t,a.onCertificateSelectToggle,a.onCertificateEmmit,a.onCertificateEdit,a.onCertificateDeleteDialogOpen,a.onCertificateRevoke,(function(){return a.state.loading}))})),i=z.getCertColumns(r,t,n,a.onCertificateSelectAllToggle,a.onEmmitedFilterChange,a.onTemplateFilterChange,a.onFirstNameFilterChange,a.onLastNameFilterChange,(function(){return a.state.loading}));a.setState({certs:e,certificates:r,filteredCertificates:r,certColumns:i})},a.onCertificateMultiEmmit=function(){var e=Object.keys(a.state.selectedCerts).filter((function(e){return a.state.selectedCerts[e]}));if(0!==e.length){a.state.certificates.filter((function(t){return e.indexOf(t._id)>-1})).forEach((function(e){e.actions=o.a.createElement("div",null),e.selected=o.a.createElement("div",null)})),a.setState({certs:a.state.certificates,loading:!0});var t=C.a.get("token"),n=Object(I.a)(a),r=[],i=e.map((function(e){return new Promise((function(a,n){ue.emmit(t,e,function(){var e=Object(v.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){r.push(e.message),a()}))}))}));Promise.all(i).then((function(){if(r.length){var e={};e.message=o.a.createElement("ul",null,r.map((function(e,t){return o.a.createElement("li",{key:"err-"+t,className:"errorList"},e)}))),n.setState({error:e,loading:!1})}else n.componentDidMount()})).catch((function(e){n.setState({error:e,loading:!1})}))}},a.onCertificateEmmit=function(e){var t=C.a.get("token"),n=Object(I.a)(a),r=n.state.certificates.find((function(t){return t._id===e}));r.actions=o.a.createElement("div",null),r.select=o.a.createElement("div",null),n.setState({certs:n.state.certificates,loading:!0}),ue.emmit(t,e,function(){var e=Object(v.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.componentDidMount();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.log(e),n.setState({error:e,loading:!1})}))},a.onCertificateEdit=function(e){a.props.history.push(S.a.ROUTES.EDIT_CERT+e)},a.onTemplateCreate=function(e){var t=e.name,n=C.a.get("token"),r=Object(I.a)(a);r.setState({loading:!0}),ne.create(n,t,function(){var e=Object(v.a)(D.a.mark((function e(t){var a,n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.state.templates,n=Y.getTemplateData(t,r.onTemplateEdit,r.onTemplateDeleteDialogOpen,(function(){return r.state.loading})),a.push(n),i=Y.getTemplateColumns(a),r.setState({templates:a,templateColumns:i,loading:!1,error:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){r.setState({loading:!1,error:e}),console.log(e)}))},a.onTemplateDeleteDialogOpen=function(e){a.templatesSection&&(a.setState({selectedTemplateId:e}),a.templatesSection.openDeleteDialog())},a.onTemplateDelete=function(){var e=a.state.selectedTemplateId,t=C.a.get("token"),n=Object(I.a)(a);n.setState({loading:!0}),ne.delete(t,e,function(){var e=Object(v.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.state.templates.filter((function(e){return e._id!==t._id})),n.setState({templates:a,loading:!1,error:!1});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({loading:!1,error:e}),console.log(e)}))},a.onFirstNameFilterChange=function(e){var t=e.target.value;a.updateFiltererCertificates(t,a.state.lastNameFilter,a.state.templateFilter,a.state.emmitedFilter),a.setState({firstNameFilter:t})},a.onLastNameFilterChange=function(e){var t=e.target.value;a.updateFiltererCertificates(a.state.firstNameFilter,t,a.state.templateFilter,a.state.emmitedFilter),a.setState({lastNameFilter:t})},a.onTemplateFilterChange=function(e){var t=e.target.value;a.updateFiltererCertificates(a.state.firstNameFilter,a.state.lastNameFilter,t,a.state.emmitedFilter),a.setState({templateFilter:t})},a.onEmmitedFilterChange=function(e){var t=e.target.value;a.updateFiltererCertificates(a.state.firstNameFilter,a.state.lastNameFilter,a.state.templateFilter,t),a.setState({emmitedFilter:t})},a.updateFiltererCertificates=function(e,t,n,r){var i=a.state.certificates;e&&""!==e&&(i=i.filter((function(t){return t.firstName.toLowerCase().includes(e.toLowerCase())}))),t&&""!==e&&(i=i.filter((function(e){return e.lastName.toLowerCase().includes(t.toLowerCase())}))),n&&(i=i.filter((function(e){return e.certName.toLowerCase().includes(n.toLowerCase())}))),r&&(i="EMITIDOS"===r?i.filter((function(e){return"-"!==e.createdOn})):i.filter((function(e){return"-"===e.createdOn}))),a.setState({filteredCertificates:i})},a.onTemplateEdit=function(e){a.props.history.push(S.a.ROUTES.EDIT_TEMPLATE+e)},a.onDelegateDeleteDialogOpen=function(e){a.delegatesSection&&(a.setState({selectedDelegateDid:e}),a.delegatesSection.openDeleteDialog())},a.onDelegateCreate=function(e){var t=e.did,n=e.name,r=C.a.get("token"),i=Object(I.a)(a);i.setState({loading:!0}),me.create(r,t,n,function(){var e=Object(v.a)(D.a.mark((function e(t){var a,n,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.state.delegates,n=Te.getDelegatesData(t,i.onDelegateDeleteDialogOpen,(function(){return i.state.loading})),a.push(n),r=Te.getDelegatesColumns(),i.setState({delegates:a,delegateColumns:r,loading:!1,error:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){i.setState({loading:!1,error:e}),console.log(e)}))},a.onDelegateDelete=function(){var e=a.state.selectedDelegateDid,t=C.a.get("token"),n=Object(I.a)(a);n.setState({loading:!0}),me.delete(t,e,function(){var e=Object(v.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.state.delegates.filter((function(e){return e.did!==t.did})),n.setState({delegates:a,loading:!1,error:!1,selectedDelegateDid:void 0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({loading:!1,error:e,selectedDelegateDid:void 0}),console.log(e)}))},a.onIssuerRename=function(e){var t=e.name,n=C.a.get("token"),r=Object(I.a)(a);r.setState({loading:!0}),me.changeIssuerName(n,t,function(){var e=Object(v.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.setState({loading:!1,error:!1,issuerName:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){r.setState({loading:!1,error:e,selectedDelegateDid:void 0}),console.log(e)}))},a.onLogout=function(){C.a.set("token",""),a.props.history.push(S.a.ROUTES.LOGIN)},a.renderRenameDialog=function(){return o.a.createElement(G,{onRef:function(e){return a.renameDialog=e},title:R.a.LIST.DIALOG.ISSUER_RENAME_TITLE(a.state.issuerName),fieldNames:["name"],onAccept:a.onIssuerRename})},a.toggleShowMenu=function(){a.setState({showMenu:!a.state.showMenu})},a.renderActions=function(e){var t=a.state.showMenu;return o.a.createElement("div",{className:"ActionsMenu"},o.a.createElement("button",{onClick:a.toggleShowMenu},R.a.LIST.MENU.TITLE),t&&o.a.createElement("div",{className:"ActionsMenuItems"},o.a.createElement("button",{disabled:e,onClick:function(){a.renameDialog&&a.renameDialog.open()}},R.a.EDIT.BUTTONS.RENAME_ISSUER),o.a.createElement("button",{onClick:a.onLogout},R.a.EDIT.BUTTONS.EXIT)))},a.state={loading:!1,showMenu:!1,tabIndex:1,partTypes:["tel","mail","personal","address"],parts:[],allSelectedParticipants:{tel:!1,mail:!1,personal:!1,address:!1},selectedParticipants:{tel:{},mail:{},personal:{},address:{}},allSelectedCerts:!1,selectedCerts:{},certificates:[],filteredCertificates:[],templates:[],delegates:[],delegateColumns:[]},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.history.location.pathname.split("/"),t="certificates"===e[e.length-1]?1:0,a=C.a.get("token"),n=this;n.setState({loading:!0,tabIndex:t}),re.getGlobal(a,function(){var e=Object(v.a)(D.a.mark((function e(t){var r,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.state.allSelectedParticipants,i=n.state.selectedParticipants,n.updateSelectedParticipantsState(t,i,r),ne.getAll(a,function(){var e=Object(v.a)(D.a.mark((function e(t){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.map((function(e){return Y.getTemplateData(e,n.onTemplateEdit,n.onTemplateDeleteDialogOpen,(function(){return n.state.loading}))})),r=Y.getTemplateColumns(t),n.setState({templates:t,templateColumns:r}),ue.getAll(a,function(){var e=Object(v.a)(D.a.mark((function e(t){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.state.selectedCerts,n.updateSelectedCertsState(t,r),me.getAll(a,function(){var e=Object(v.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.map((function(e){return Te.getDelegatesData(e,n.onDelegateDeleteDialogOpen,(function(){return n.state.loading}))})),a=Te.getDelegatesColumns(),n.setState({delegateColumns:a,delegates:t,error:!1,loading:!1});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)})),me.getIssuerName(a,(function(e){n.setState({issuerName:e})}),(function(e){n.setState({error:e}),console.log(e)}))}},{key:"render",value:function(){var e=this;return C.a.get("token")?o.a.createElement(P.d,{selectedIndex:this.state.tabIndex,onSelect:function(t){return e.setState({tabIndex:t,error:!1})}},this.renderRenameDialog(),this.renderActions(this.state.loading),o.a.createElement(P.b,null,o.a.createElement(P.a,{disabled:this.state.loading&&0!==this.state.tabIndex},R.a.LIST.BUTTONS.TO_TEMPLATES),o.a.createElement(P.a,{disabled:this.state.loading&&1!==this.state.tabIndex},R.a.LIST.BUTTONS.TO_CERTIFICATES),o.a.createElement(P.a,{disabled:this.state.loading&&2!==this.state.tabIndex},R.a.LIST.BUTTONS.TO_QR),o.a.createElement(P.a,{disabled:this.state.loading&&3!==this.state.tabIndex},R.a.LIST.BUTTONS.DELEGATES)),o.a.createElement(P.c,null,o.a.createElement(Q,{onRef:function(t){return e.templatesSection=t},selected:0===this.state.tabIndex,templates:this.state.templates,columns:this.state.templateColumns,loading:this.state.loading,error:this.state.error,onCreate:this.onTemplateCreate,onDelete:this.onTemplateDelete})),o.a.createElement(P.c,null,o.a.createElement(W,{onRef:function(t){return e.certificatesSection=t},selected:1===this.state.tabIndex,certificates:this.state.filteredCertificates,columns:this.state.certColumns,loading:this.state.loading,onMultiEmmit:this.onCertificateMultiEmmit,onDelete:this.onCertificateDelete,error:this.state.error})),o.a.createElement(P.c,null,o.a.createElement(le,{selected:2===this.state.tabIndex,loading:this.state.loading,templates:this.state.templates,participants:this.state.participants,columns:this.state.participantColumns,error:this.state.error,onReload:this.onParticipantsReload,selectedParticipants:this.state.selectedParticipants})),o.a.createElement(P.c,null,o.a.createElement(de,{onRef:function(t){return e.delegatesSection=t},loading:this.state.loading,selected:3===this.state.tabIndex,delegates:this.state.delegates,columns:this.state.delegateColumns,onRename:this.onIssuerRename,onCreate:this.onDelegateCreate,onDelete:this.onDelegateDelete,issuerName:this.state.issuerName,error:this.state.error}))):o.a.createElement(p.a,{to:S.a.ROUTES.LOGIN})}}]),t}(i.Component),fe=Object(p.g)(pe),Se=(a(261),a(262),a(152)),Ae=a.n(Se),De=a(153),ve=a.n(De),Ie=a(154),ge=a.n(Ie),Ce=(a(263),function e(){Object(s.a)(this,e)});Ce.renderData=function(e,t,a,n,r){var i=void 0!==e.value?e.value:e.defaultValue;if(e.name===S.a.TEMPLATES.MANDATORY_DATA.NAME)return o.a.createElement("div",{className:"DataInput Mandatory"},i);if(r&&Object.values(S.a.TEMPLATES.MANDATORY_DATA).indexOf(e.name)>=0)return o.a.createElement("div",{className:"DataInput Mandatory"},i);switch(e.type){case S.a.TEMPLATES.TYPES.BOOLEAN:return o.a.createElement(J.a,{className:"DataInput Boolean",disabled:!a,autoFocus:!0,value:i||"",onChange:function(a){n(e,a.target.value,t)}},o.a.createElement(Z.a,{className:"DataInput",value:"true"},S.a.TEMPLATES.EDIT.BOOLEAN.TRUE),o.a.createElement(Z.a,{className:"DataInput",value:"false"},S.a.TEMPLATES.EDIT.BOOLEAN.FALSE));case S.a.TEMPLATES.TYPES.CHECKBOX:return o.a.createElement(J.a,{className:"DataInput Checkbox",disabled:!a,autoFocus:!0,value:i||e.options[0],onChange:function(a){n(e,a.target.value,t)}},e.options.map((function(e,t){return o.a.createElement(Z.a,{value:e,key:"option-"+t,className:"DataInput"},e)})));case S.a.TEMPLATES.TYPES.DATE:return o.a.createElement(ge.a,{disabled:!a,className:"DataInput Date",selected:i?new Date(i):void 0,onChange:function(a){a=ve()(a,"yyyy-mm-dd hh:MM:ss"),n(e,a.replace(" ","T")+"Z",t)},dateFormat:"dd-MM-yyyy"});case S.a.TEMPLATES.TYPES.NUMBER:return o.a.createElement(Ae.a,{className:"DataInput Number",disabled:!a,value:i,onChange:function(a){n(e,a,t)}});case S.a.TEMPLATES.TYPES.PARAGRAPH:return o.a.createElement("textarea",{className:"DataInput Paragraph",disabled:!a,value:i,onChange:function(a){n(e,a.target.value,t)}});case S.a.TEMPLATES.TYPES.TEXT:default:var c=i||"";return o.a.createElement("input",{type:"text",className:"DataInput",disabled:!a,value:c,onChange:function(a){n(e,a.target.value,t)}})}},Ce.renderRequired=function(e,t,a){return o.a.createElement("div",{className:"DataRequired",onClick:function(){a(e,t)}},(e.required||e.mandatory)&&o.a.createElement(V.a,{icon:S.a.TEMPLATES.EDIT.ICONS.REQUIRED,color:"#bdbfbe"}),!e.required&&!e.mandatory&&o.a.createElement(V.a,{icon:S.a.TEMPLATES.EDIT.ICONS.NOT_REQUIRED,color:"#bdbfbe"}),o.a.createElement("div",null,R.a.EDIT.BUTTONS.REQUIRED))},Ce.renderDelete=function(e,t,a){return e.mandatory?o.a.createElement("div",null):o.a.createElement("div",{className:"DataDelete",onClick:function(){a(e,t)}},o.a.createElement(V.a,{icon:S.a.TEMPLATES.EDIT.ICONS.DELETE,color:"#eb4646"}),o.a.createElement("div",null,R.a.EDIT.BUTTONS.DELETE))};var he=a(384),Oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).cleanData=function(){a.setState({name:"",dataType:S.a.TEMPLATES.TYPES.TEXT,options:[],required:!1})},a.open=function(e){a.cleanData(),a.setState({type:e,isOpen:!0})},a.close=function(){a.cleanData(),a.setState({type:void 0,isOpen:!1})},a.createField=function(){var e=a.state.type,t={name:a.state.name,type:a.state.dataType,mandatory:!1,required:a.state.required,options:a.state.options.length?a.state.options:[]};a.props.onAccept(t,e)},a.render=function(){var e=a.props.title,t=a.state.dataType===S.a.TEMPLATES.TYPES.CHECKBOX;return o.a.createElement(j.a,{open:a.state.isOpen,onClose:a.close,"aria-labelledby":"form-dialog-title"},o.a.createElement(U.a,{className:"DialogTitle"},e),o.a.createElement(F.a,null,a.renderDialogName(),t&&a.renderDialogCheckbox(),a.renderDialogTypes(),a.renderDialogRequired()),o.a.createElement(B.a,null,o.a.createElement(k.a,{onClick:a.close,color:"primary"},R.a.EDIT.DIALOG.FIELD.CLOSE),o.a.createElement(k.a,{onClick:a.createField,disabled:!a.state.name||a.state.dataType===S.a.TEMPLATES.TYPES.CHECKBOX&&!a.state.options.length,color:"primary"},R.a.EDIT.DIALOG.FIELD.CREATE)))},a.renderDialogName=function(){return o.a.createElement(M.a,{autoFocus:!0,margin:"dense",id:"name",label:R.a.EDIT.DIALOG.FIELD.NAME,type:"text",value:a.state.name,onChange:function(e){return a.setState({name:e.target.value})},fullWidth:!0})},a.renderDialogRequired=function(){return o.a.createElement("div",{id:"Required"},o.a.createElement("input",{className:"RequiredInput",type:"checkbox",onChange:function(e){a.setState({required:e.target.checked})}}),o.a.createElement("div",{className:"RequiredText"},R.a.EDIT.DIALOG.FIELD.REQUIRED))},a.renderDialogTypes=function(){var e=S.a.TEMPLATES.TYPES;return a.state.type===S.a.TEMPLATES.DATA_TYPES.PARTICIPANT&&(e=Object.assign({},S.a.TEMPLATES.TYPES,S.a.TEMPLATES.SHARED_TYPES)),o.a.createElement("div",{id:"Types"},o.a.createElement(he.a,null,R.a.EDIT.DIALOG.FIELD.TYPES),o.a.createElement(J.a,{className:"DialogTypeDropdown",autoFocus:!0,value:a.state.dataType,onChange:function(e){Object.keys(S.a.TEMPLATES.SHARED_TYPES).indexOf(e.target.value)>=0?a.setState({name:e.target.value,dataType:"Text"}):a.setState({dataType:e.target.value})}},Object.values(e).map((function(e,t){return o.a.createElement(Z.a,{value:e,key:"type-"+t},e)}))))},a.renderDialogCheckbox=function(){return o.a.createElement("div",null,o.a.createElement("div",{id:"Options"},o.a.createElement(M.a,{autoFocus:!0,margin:"dense",id:"option",label:R.a.EDIT.DIALOG.FIELD.OPTION,type:"text",onChange:function(e){return a.setState({option:e.target.value})},fullWidth:!0}),o.a.createElement("div",{id:"OptionAdd",onClick:function(){a.state.options.push(a.state.option),a.setState({options:a.state.options,option:""})}},o.a.createElement(V.a,{id:"AddOptionIcon",icon:S.a.TEMPLATES.EDIT.ICONS.ADD_OPTION,color:"#3f51b5"}))),a.state.options.map((function(e,t){return o.a.createElement("div",{key:"opt-"+t},e,o.a.createElement(V.a,{id:"DeleteIcon",icon:S.a.TEMPLATES.EDIT.ICONS.REMOVE_OPTION,color:"rgb(235, 70, 70)",onClick:function(){a.state.options.splice(t,1),a.setState({options:a.state.options,option:""})}}))})))},a.state={isOpen:!1,name:"",options:[],dataType:S.a.TEMPLATES.TYPES.TEXT,required:!1},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}}]),t}(i.Component),Re=a(383),Le=a(374),Ne=a(377),Pe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(E.a)(this,Object(d.a)(t).call(this,e))).onBack=function(){n.state.loading&&n.state.error?n.setState({loading:!1,error:!1}):n.props.history.push(S.a.ROUTES.TEMPLATES)},n.createField=function(e,t){n.templateFieldAddDialog&&n.templateFieldAddDialog.close(),n.state.template.data[t].push(e),n.setState({template:n.state.template})},n.toggleRequired=function(e,t){var a=n.state.template.data[t].find((function(t){return t.name===e.name}));a&&!a.mandatory&&(a.required=!a.required,n.setState({template:n.state.template}))},n.setDefaultValue=function(e,t,a){var r=n.state.template.data[a].find((function(t){return t.name===e.name}));r&&(r.defaultValue=t,n.setState({template:n.state.template}))},n.onPreviewFieldsSelected=function(e){var t=n.state.template;t.previewData=e.target.value,t.previewType=n.state.radioValue,n.setState({template:t})},n.deleteField=function(e,t){var a=n.state.template;a.data[t]=a.data[t].filter((function(t){return t.name!==e.name})),a.previewData=a.previewData.filter((function(t){return t!==e.name})),n.setState({template:a})},n.onSave=function(){var e=C.a.get("token"),t=n.state.template;t.previewType=n.state.radioValue;var a=Object(I.a)(n);a.setState({loading:!0}),ne.save(e,t,function(){var e=Object(v.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({loading:!1,error:!1}),a.props.history.push(S.a.ROUTES.LIST);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){a.setState({error:e}),console.log(e)}))},n.renderDialog=function(){return o.a.createElement(Oe,{onRef:function(e){return n.templateFieldAddDialog=e},title:R.a.EDIT.DIALOG.FIELD.TITLE,onAccept:n.createField})},n.renderTemplateCategory=function(){var e=n.state.template,t=S.a.TEMPLATES.CATEGORIES;return o.a.createElement("div",null,o.a.createElement("h2",{className:"DataTitle"},R.a.EDIT.DATA.CATEGORIES),o.a.createElement(J.a,{className:"CategoriesPicker",displayEmpty:!0,value:e.category?e.category:"",onChange:function(t){e.category=t.target.value,n.setState({template:e})},renderValue:function(e){return e}},t.map((function(e,t){return o.a.createElement(Z.a,{key:"Category-"+t,value:e},o.a.createElement(ae.a,{primary:e}))}))))},n.renderTemplateType=function(){var e=n.state.template,t=e.data.cert.concat(e.data.others).concat(e.data.participant).filter((function(e){return e.required})).map((function(e){return e.name})),r=n.state.radioValue,i=S.a.TEMPLATES.PREVIEW_ELEMS_LENGTH[r]-n.state.template.previewData.length;return o.a.createElement("div",{className:"Template-Type"},o.a.createElement("h2",{className:"DataTitle"},R.a.EDIT.DATA.PREVIEW),o.a.createElement(Re.a,{className:"PreviewFieldTypePicker","aria-label":"gender",name:"gender1",value:r,onChange:function(e){n.setState({radioValue:e.target.value})}},o.a.createElement("div",{className:"PreviewFieldItem"},o.a.createElement(Le.a,{value:"1",checked:"1"===r,control:o.a.createElement(Ne.a,null)}),o.a.createElement("img",{src:a(320),className:"PreviewFieldTypeImage",alt:"type 1"})),o.a.createElement("div",{className:"PreviewFieldItem"},o.a.createElement(Le.a,{value:"2",checked:"2"===r,control:o.a.createElement(Ne.a,null)}),o.a.createElement("img",{src:a(321),className:"PreviewFieldTypeImage",alt:"type 2"})),o.a.createElement("div",{className:"PreviewFieldItem"},o.a.createElement(Le.a,{value:"3",checked:"3"===r,control:o.a.createElement(Ne.a,null)}),o.a.createElement("img",{src:a(322),className:"PreviewFieldTypeImage",alt:"type 3"}))),o.a.createElement(J.a,{className:"PreviewFieldsSelect",multiple:!0,displayEmpty:!0,value:n.state.template.previewData,onChange:n.onPreviewFieldsSelected,renderValue:function(e){return e.join(", ")}},t.map((function(e,t){return o.a.createElement(Z.a,{key:"PreviewFields-"+t,value:e},o.a.createElement(K.a,{checked:n.state.template.previewData.indexOf(e)>-1}),o.a.createElement(ae.a,{primary:e}))}))),i>0&&o.a.createElement("div",null,"Seleccione ",i," mas"),i<0&&o.a.createElement("div",null,"Agrego de mas, quite ",-1*i))},n.renderTemplate=function(){var e=n.state.template;return o.a.createElement("div",{className:"Template-Content"},n.renderSection(R.a.EDIT.DATA.CERT,e.data.cert,S.a.TEMPLATES.DATA_TYPES.CERT),n.renderSection(R.a.EDIT.DATA.PART,e.data.participant,S.a.TEMPLATES.DATA_TYPES.PARTICIPANT),n.renderSection(R.a.EDIT.DATA.OTHER,e.data.others,S.a.TEMPLATES.DATA_TYPES.OTHERS))},n.renderSection=function(e,t,a){return o.a.createElement("div",{className:"TemplateSectionContent"},o.a.createElement("h2",{className:"DataTitle"},e),t.map((function(e,t){return o.a.createElement("div",{className:"Data",key:"template-elem-"+t},o.a.createElement("div",{className:"DataName"},e.name),o.a.createElement("div",{className:"DataElem"},Ce.renderData(e,a,!0,n.setDefaultValue,!0),Ce.renderRequired(e,a,n.toggleRequired,!0),Ce.renderDelete(e,a,n.deleteField,!0)))})),n.renderSectionButtons(a))},n.renderSectionButtons=function(e){return o.a.createElement("div",{className:"SectionButtons"},o.a.createElement("button",{className:"AddButton",onClick:function(){n.templateFieldAddDialog&&n.templateFieldAddDialog.open(e)}},o.a.createElement("div",{className:"AddButton"},o.a.createElement(V.a,{icon:S.a.TEMPLATES.ICONS.ADD_BUTTON}),o.a.createElement("div",{className:"AddButtonText"},R.a.EDIT.BUTTONS.CREATE))))},n.renderButtons=function(){return o.a.createElement("div",{className:"TemplateButtons"},o.a.createElement("button",{className:"SaveButton",onClick:n.onSave},R.a.EDIT.BUTTONS.SAVE),o.a.createElement("button",{className:"BackButton",onClick:n.onBack},R.a.EDIT.BUTTONS.BACK))},n.state={loading:!0,typingTimeout:0,typing:!1,radioValue:1},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.history.location.pathname.split("/"),t=e[e.length-1],a=C.a.get("token"),n=this;this.setState({loading:!0}),ne.get(a,t,function(){var e=Object(v.a)(D.a.mark((function e(a){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({id:t,template:a,radioValue:a.previewType,loading:!1,error:!1});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)}))}},{key:"render",value:function(){if(!C.a.get("token"))return o.a.createElement(p.a,{to:S.a.ROUTES.LOGIN});var e=this.state.loading;return o.a.createElement("div",{className:e?"Loading Template":"Template"},y.render(e),this.renderDialog(),!e&&this.renderTemplateType(),!e&&this.renderTemplateCategory(),!e&&this.renderTemplate(),this.renderButtons(),o.a.createElement("div",{className:"errMsg"},this.state.error&&this.state.error.message))}}]),t}(i.Component),_e=Object(p.g)(Pe),be=(a(323),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(E.a)(this,Object(d.a)(t).call(this,e))).getTemplates=function(e){var t=this;return new Promise((function(a,n){ne.getAll(e,(function(e){t.setState({templates:e}),a()}),(function(e){n(e)}))}))},a.getCert=function(e,t){var a=this;return new Promise((function(n,r){ue.get(e,t,(function(e){a.setState({cert:e,error:!1}),n()}),(function(e){r(e)}))}))},a.getTemplate=function(e){var t=this,a=this,n=this.state.cert.emmitedOn?"viewing":"editing",r=this.state.templates.find((function(e){return e._id===t.state.cert.templateId}));return new Promise((function(t,i){ne.get(e,r._id,(function(e){a.setState({action:n,selectedTemplate:r,template:e,error:!1}),t()}),(function(e){i(e)}))}))},a.getParticipants=function(){var e=this,t=C.a.get("token");return new Promise((function(a,n){re.getAll(t,e.state.template._id,(function(t){e.setState({participants:t,error:!1}),a()}),(function(e){n(e)}))}))},a.certFromTemplate=function(e){var t={cert:a.certDataFromTemplate(e,"cert"),participant:[a.certDataFromTemplate(e,"participant")],others:a.certDataFromTemplate(e,"others")};return{templateId:e._id,split:!1,microCredentials:[],data:t}},a.certDataFromTemplate=function(e,t){return e.data[t].map((function(e){return{name:e.name,type:e.type,options:e.options,value:e.defaultValue?e.defaultValue:"",required:e.required,mandatory:e.mandatory}}))},a.onDataReceived=function(e){a.onParticipantsAdd(e)},a.addParticipant=function(){a.state.cert.data.participant.push(a.certDataFromTemplate(a.state.template,"participant")),a.setState({cert:a.state.cert})},a.createSampleCsv=function(){for(var e=function(e){switch(e.type){case S.a.TEMPLATES.TYPES.BOOLEAN:return"true/false";case S.a.TEMPLATES.TYPES.CHECKBOX:var t="";return e.options.forEach((function(e){return t+=e+"/"})),t=t.substring(0,t.length-1);case S.a.TEMPLATES.TYPES.DATE:return"ej: 10/12/2020";case S.a.TEMPLATES.TYPES.NUMBER:return"un n\xfamero";case S.a.TEMPLATES.TYPES.TEXT:return e.name===S.a.TEMPLATES.MANDATORY_DATA.DID?"ej: did:ethr:0x5f6ed832a5fd0f0a58135f9695ea40af8666db31":"un texto";case S.a.TEMPLATES.TYPES.PARAGRAPH:return"un parrafo";default:return""}},t="",n="",r=a.state.cert.data.cert,i=0,o=Object.keys(r);i<o.length;i++){var c=o[i];r[c].mandatory||(t+=r[c].name+" ("+e(r[c])+")",t+=r[c].required?"*,":",",n+=",")}var l=a.state.cert.data.others;if(l)for(var s=0,u=Object.keys(l);s<u.length;s++){var E=u[s];l[E].mandatory||(t+=l[E].name+" ("+e(l[E])+")",t+=l[E].required?"*,":",",n+=",")}for(var d=a.state.cert.data.participant[0],m=0,T=Object.keys(d);m<T.length;m++){var p=T[m];t+=d[p].name+" ("+e(d[p])+")",t+=d[p].required?"*,":",",n+=","}t+="\n"+(n=n.substring(0,n.length-1));var f=document.createElement("a"),A=new Blob([t],{type:"text/plain"});f.href=URL.createObjectURL(A),f.download="sample.csv",document.body.appendChild(f),f.click()},a.validateDID=function(e){e.match(/did:ethr:0x[0-9A-Fa-f]{40}/)?this.state.error&&this.setState({error:void 0}):this.state.error||this.setState({error:{message:S.a.CERTIFICATES.ERR.INVALID_DID}})},a.loadCertFromCsv=function(e){var t=function(e,t){if(""===t||" "===t){if(e.required)return S.a.CERTIFICATES.ERR.CSV_REQUIRED_VALUE_MISSING(e.name)}else if(!function(e,t){switch(e.type){case S.a.TEMPLATES.TYPES.BOOLEAN:return e.value=t,"TRUE"===t&&(e.value=!0),"FALSE"===t&&(e.value=!0),!0;case S.a.TEMPLATES.TYPES.CHECKBOX:return!!e.options.find((function(e){return e===t+""}))&&(e.value=t,!0);case S.a.TEMPLATES.TYPES.DATE:try{var a=t.split("/"),n=new Date(a[2],a[1]-1,a[0]);return n instanceof Date&&!isNaN(n)&&(e.value=n,!0)}catch(r){return console.log(r),!1}case S.a.TEMPLATES.TYPES.NUMBER:return!isNaN(t)&&(e.value=t,!0);case S.a.TEMPLATES.TYPES.PARAGRAPH:case S.a.TEMPLATES.TYPES.TEXT:return!!t&&(e.value=t,!0);default:return!1}}(e,t))return S.a.CERTIFICATES.ERR.CSV_REQUIRED_VALUE_INVALID(e.name)},n=Object(I.a)(a),r=new FileReader;r.onload=function(e){var a=[],i=r.result.split(/[\r\n]+/);i.shift(),i=(i=i.join(",")).split(",");var o=JSON.parse(JSON.stringify(n.state.cert.data.cert)),c=JSON.parse(JSON.stringify(n.state.cert.data.others)),l=n.certDataFromTemplate(n.state.template,"participant"),s=Object.keys(o),u=Object.keys(c),E=Object.keys(l),d=s.length-1,m=u.length,T=E.length;if(d+m+T>i.length){var p=S.a.CERTIFICATES.ERR.CSV_MISSING_FIELDS();return n.setState({error:p})}for(var f=0,A=0,D=s;A<D.length;A++){var v=o[D[A]];if(!v.mandatory){var I=t(v,i[f]);if(I)return n.setState({error:I});f++}}for(var g=0,C=u;g<C.length;g++){var h=c[C[g]];if(!h.mandatory){var O=t(h,i[f]);if(O)return n.setState({error:O});f++}}do{var R=n.certDataFromTemplate(n.state.template,"participant"),L=!0,N=!1,P=void 0;try{for(var _,b=R[Symbol.iterator]();!(L=(_=b.next()).done);L=!0){var y=_.value;if(i.length>f){var M=t(y,i[f]);if(M)return n.setState({error:M});y.name===S.a.CERTIFICATES.MANDATORY_DATA.DID&&n.validateDID(y.value),f++}}}catch(p){N=!0,P=p}finally{try{L||null==b.return||b.return()}finally{if(N)throw P}}f+=d+m,a.push(R)}while(i.length-f>=T);n.state.cert.data.cert=o,n.state.cert.data.participant=a,n.state.cert.data.others=c,n.setState({cert:n.state.cert,error:void 0})},r.readAsText(e[0])},a.removeParticipant=function(e){if(1===a.state.cert.data.participant.length)for(var t=a.state.cert.data.participant[0],n=0,r=Object.keys(t);n<r.length;n++){t[r[n]].value=""}else a.state.cert.data.participant.splice(e,1);var i=!0,o=!1,c=void 0;try{for(var l,s=a.state.cert.data.participant[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var u=l.value;if(a.validateDID(u[0].value),a.state.error)break}}catch(E){o=!0,c=E}finally{try{i||null==s.return||s.return()}finally{if(o)throw c}}a.setState({cert:a.state.cert})},a.templateSelected=function(e){var t=C.a.get("token"),n=Object(I.a)(a);n.setState({loading:!0}),ne.get(t,e._id,(function(a){re.getAll(t,a._id,(function(t){n.setState({selectedTemplate:e,participants:t,template:a,error:!1,cert:n.certFromTemplate(a),loading:!1,action:"creating"})}),(function(e){n.setState({error:e}),console.log(e)}))}),(function(e){n.setState({error:e}),console.log(e)}))},a.onParticipantsAdd=function(e){var t=a.state.cert.data.participant.length,n=0;if(0!==e.length){var r=!0,i=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;n>=t&&a.addParticipant(),a.participantSelected(s.did,n),n++}}catch(u){i=!0,o=u}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}t>=n&&a.state.cert.data.participant.splice(n,t-n)}},a.onSave=function(){var e=C.a.get("token"),t=a.state.cert,n=Object(I.a)(a);n.setState({loading:!0}),ue.save(e,t,function(){var e=Object(v.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({loading:!1,error:!1}),n.props.history.push(S.a.ROUTES.CERTIFICATES);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){n.setState({error:e}),console.log(e)}))},a.addMicroCredential=function(){var e=a.state.cert;e.microCredentials.push({title:"",names:[]}),a.setState({cert:e})},a.removeMicroCredential=function(e){var t=a.state.cert;t.microCredentials.length>1&&(t.microCredentials.splice(e,1),a.setState({cert:t}))},a.microcredFieldsSelected=function(e,t){var n=a.state.cert;n.microCredentials[e].names=t.target.value,a.setState({cert:n})},a.microcredNameChanged=function(e,t){var n=a.state.cert;n.microCredentials[e].title=t.target.value,a.setState({cert:n})},a.splitChanged=function(e){var t=a.state.cert;t.split=e,t.microCredentials="true"===e?[{title:"",names:[]}]:[],a.setState({cert:t})},a.onBack=function(){a.state.loading&&a.state.error?a.setState({loading:!1,error:!1}):a.props.history.push(S.a.ROUTES.CERTIFICATES)},a.updateErrorDelayed=function(e){var t=Object(I.a)(a);setTimeout((function(){e&&a.state.error||t.setState({error:e})}),500)},a.saveDisabled=function(){if(!a.state.cert)return!0;var e=a.state.cert.data.participant[0][0].value;if(e&&!e.match(/^did:ethr:0x[0-9A-Za-z]{40}$/))return a.state.error||a.updateErrorDelayed({message:S.a.CERTIFICATES.ERR.INVALID_DID}),!0;a.state.error&&a.state.error.message===S.a.CERTIFICATES.ERR.INVALID_DID&&a.updateErrorDelayed(!1);var t=a.state.cert.data.cert,n=a.state.cert.data.participant.flat(),r=a.state.cert.data.others,i=t.concat(n).concat(r);for(var o in i){var c=i[o];if(c.name===S.a.CERT_FIELD_MANDATORY.EXPIRATION_DATE){if(new Date(c.value)<new Date)return a.state.error||a.updateErrorDelayed(S.a.CERTIFICATES.ERR.EXP_DATE_INVALID),!0;a.state.error&&a.state.error.message===S.a.CERTIFICATES.ERR.EXP_DATE_INVALID.message&&a.updateErrorDelayed(!1)}if(c.required&&!c.value)return a.state.error||a.updateErrorDelayed(S.a.CERTIFICATES.ERR.MISSING_FIELD(c.name)),!0;a.state.error&&a.state.error.message===S.a.CERTIFICATES.ERR.MISSING_FIELD(c.name).message&&a.updateErrorDelayed(!1)}return!1},a.generateQrCode=function(){var e=C.a.get("token"),t=Object(I.a)(a);t.setState({loading:!0,qr:void 0});var n=Math.random().toString(36).slice(-8);ne.getQrPetition(e,t.state.template._id,n,(function(e){t.setState({requestCode:n,qr:e,loading:!1,qrSet:!1,error:!1})}),(function(e){t.setState({error:e}),console.log(e)}))},a.renderQrDialog=function(){return o.a.createElement(oe,{loading:a.state.loading,onRef:function(e){return a.qrDialog=e},title:R.a.EDIT.DIALOG.QR.LOAD_BY_QR,onDataReceived:a.onDataReceived,template:a.state.template,templates:a.state.templates,participants:a.state.participants})},a.renderSplit=function(e){var t=e.data.cert.concat(e.data.participant[0]).concat(e.data.others).map((function(e){return e.name}));return o.a.createElement("div",{className:"Data"},o.a.createElement("div",{className:"DataName"},S.a.CERTIFICATES.EDIT.SPLIT),o.a.createElement("div",{className:"DataElem"},o.a.createElement(J.a,{className:"DataInput Boolean",autoFocus:!0,value:!!e.split&&e.split,onChange:function(e){a.splitChanged(e.target.value)}},o.a.createElement(Z.a,{className:"DataInput",value:"true"},S.a.TEMPLATES.EDIT.BOOLEAN.TRUE),o.a.createElement(Z.a,{className:"DataInput",value:"false"},S.a.TEMPLATES.EDIT.BOOLEAN.FALSE))),e.split&&e.microCredentials&&e.microCredentials.length>0&&o.a.createElement("div",{className:"MicroCreds"},o.a.createElement("div",{className:"MicroCredsHeader"},o.a.createElement("div",{className:"DataName MicroCredsNameLabel"},R.a.EDIT.DATA.MICRO_CRED_NAME),o.a.createElement("div",{className:"DataName MicroCredsFieldsLabel"},R.a.EDIT.DATA.MICRO_CRED_FIELDS)),e.microCredentials.map((function(n,r){for(var i=[],c=0;c<e.microCredentials.length;c++)c!==r&&(i=i.concat(e.microCredentials[c].names));var l=t.filter((function(e){return i.indexOf(e)<0}));return o.a.createElement("div",{className:"DataElem",key:"Microcred-"+r},o.a.createElement("input",{type:"text",className:"DataInput MicroCredFieldName",value:n.title,onChange:function(e){a.microcredNameChanged(r,e)}}),o.a.createElement(J.a,{className:"MicroCredFieldsSelect",multiple:!0,displayEmpty:!0,value:n.names,onChange:function(e){a.microcredFieldsSelected(r,e)},renderValue:function(e){return e.join(", ")}},l.map((function(e,t){return o.a.createElement(Z.a,{key:"MicroCred-"+r+"-Fields-"+t,value:e},o.a.createElement(K.a,{checked:n.names.indexOf(e)>-1}),o.a.createElement(ae.a,{primary:e}))}))),o.a.createElement("button",{title:R.a.EDIT.BUTTONS.ADD_MICRO_CRED_LABEL,className:"AddMicroCredential",onClick:a.addMicroCredential},R.a.EDIT.BUTTONS.ADD_MICRO_CRED),o.a.createElement("button",{title:R.a.EDIT.BUTTONS.REMOVE_MICRO_CRED_LABEL,hidden:0===r,className:"RemoveMicroCredential",onClick:function(){a.removeMicroCredential(r)}},R.a.EDIT.BUTTONS.REMOVE_MICRO_CRED))}))))},a.renderCert=function(){var e=a.state.cert;if(!e)return o.a.createElement("div",null);var t=e.data.cert,n=e.data.others,r=e.data.participant,i="viewing"===a.state.action;return o.a.createElement("div",{className:"CertSectionContent"},!i&&a.renderSplit(e),a.renderSection(e,t,S.a.TEMPLATES.DATA_TYPES.CERT),a.renderSection(e,n,S.a.TEMPLATES.DATA_TYPES.OTHERS),r.map((function(t,n){return o.a.createElement("div",{className:"ParticipantContent",key:"part-"+n},o.a.createElement("div",{hidden:0===n},o.a.createElement("button",{className:"RemoveParticipantButton",hidden:a.state.viewing,onClick:function(){return a.removeParticipant(n)}},R.a.EDIT.BUTTONS.REMOVE_PARTICIPANTS)),a.renderSection(e,t))})),o.a.createElement("div",null,"(* requerido)"))},a.renderSection=function(e,t,n){var r=Object(I.a)(a);return o.a.createElement("div",{className:"CertSectionContent"},t.map((function(t,i){return t.name===S.a.TEMPLATES.MANDATORY_DATA.NAME?o.a.createElement("div",{key:"template-elem-"+i}):o.a.createElement("div",{className:"Data",key:"template-elem-"+i},o.a.createElement("div",{className:"DataName"},t.name),o.a.createElement("div",{className:"DataElem"},Ce.renderData(t,n,"creating"===a.state.action||"editing"===a.state.action,(function(t,n){t.value=n,a.state.error&&a.setState({error:void 0}),r.setState({cert:e})})),o.a.createElement("div",{className:"RequiredMarker"},t.required?" * ":"   ")))})))},a.renderTemplateSelector=function(){var e=a.state.templates;return e?o.a.createElement("div",{className:"TemplateSelector"},o.a.createElement("div",{className:"DataName"},S.a.CERTIFICATES.EDIT.TEMPLATE_SELECT_MESSAGE),o.a.createElement(te.a,{options:e,getOptionLabel:function(e){return e?e.name:""},value:a.state.selectedTemplate?a.state.selectedTemplate:"",renderInput:function(e){return o.a.createElement(M.a,Object.assign({},e,{variant:"standard",label:"",placeholder:"",fullWidth:!0}))},onChange:function(e,t){a.templateSelected(t)}})):o.a.createElement("div",null)},a.renderButtons=function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"AddParticipantButtons"},o.a.createElement("button",{className:"CertButton AddParticipant",hidden:"viewing"===a.state.action||"editing"===a.state.action,onClick:a.addParticipant},R.a.EDIT.BUTTONS.ADD_PARTICIPANTS),o.a.createElement("button",{className:"CertButton LoadParticipant",hidden:"viewing"===a.state.action||"editing"===a.state.action,onClick:function(){a.qrDialog&&a.qrDialog.open()}},R.a.EDIT.BUTTONS.LOAD_PARTICIPANTS),o.a.createElement("button",{className:"CertButton SampleCsv",hidden:"viewing"===a.state.action||"editing"===a.state.action,onClick:a.createSampleCsv},R.a.EDIT.BUTTONS.SAMPLE_CERT_FROM_CSV),o.a.createElement(ee.a,{handleFiles:a.loadCertFromCsv,fileTypes:".csv"},o.a.createElement("button",{className:"CertButton",hidden:"viewing"===a.state.action||"editing"===a.state.action},R.a.EDIT.BUTTONS.LOAD_CERT_FROM_CSV))),o.a.createElement("div",{className:"CertificateButtons"},o.a.createElement("button",{hidden:"viewing"===a.state.action,className:"SaveButton",disabled:a.saveDisabled(),onClick:a.onSave},R.a.EDIT.BUTTONS.SAVE),o.a.createElement("button",{className:"BackButton",onClick:a.onBack},R.a.EDIT.BUTTONS.BACK)))},a.state={loading:!1,action:"viewing"},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillUnmount",value:function(){void 0}},{key:"componentDidMount",value:function(){var e=this.props.history.location.pathname.split("/"),t=e[e.length-1],a=C.a.get("token"),n=this;Object(v.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.prev=1,e.next=4,n.getTemplates(a);case 4:if(!t){e.next=11;break}return e.next=7,n.getCert(a,t);case 7:return e.next=9,n.getTemplate(a);case 9:return e.next=11,n.getParticipants();case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),n.setState({error:e.t0}),console.log(e.t0);case 17:n.setState({loading:!1});case 18:case"end":return e.stop()}}),e,null,[[1,13]])})))()}},{key:"participantSelected",value:function(e,t){var a=this,n=C.a.get("token");a.setState({loading:!0}),re.get(n,e,(function(e){var n=a.state.cert.data.participant[t];if(e.data){e.data.forEach((function(e){var t=n.find((function(t){var a=t.name.toLowerCase(),n=S.a.TEMPLATES.TYPE_MAPPING[t.name],r=e.name.toLowerCase();return a===r||n&&n.toLowerCase()===r}));t&&(t.value=e.value)}));var r=n.find((function(e){return"did"===e.name.toLowerCase()}));r&&(r.value=e.did)}a.setState({participants:a.state.participants,error:!1,action:a.state.action,loading:!1})}),(function(e){a.setState({error:e}),console.log(e)}))}},{key:"render",value:function(){if(!C.a.get("token"))return o.a.createElement(p.a,{to:S.a.ROUTES.LOGIN});var e=this.state.loading,t=this.state.error;return o.a.createElement("div",{className:e?"Certificate Loading":"Certificate"},y.render(e),this.renderTemplateSelector(),!e&&this.renderCert(),this.renderQrDialog(),this.renderButtons(),o.a.createElement("div",{className:"errMsg"},t&&t.message))}}]),t}(i.Component)),ye=Object(p.g)(be),Me=function(e){function t(){return Object(s.a)(this,t),Object(E.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(T.a,null,o.a.createElement(p.d,null,o.a.createElement(p.b,{exact:!0,path:"/",component:N}),o.a.createElement(p.b,{exact:!0,path:S.a.ROUTES.LOGIN,component:N}),o.a.createElement(p.b,{exact:!0,path:S.a.ROUTES.LIST,component:fe}),o.a.createElement(p.b,{exact:!0,path:S.a.ROUTES.TEMPLATES,component:fe}),o.a.createElement(p.b,{exact:!0,path:S.a.ROUTES.CERTIFICATES,component:fe}),o.a.createElement(p.b,{path:S.a.ROUTES.EDIT_TEMPLATE,component:_e}),o.a.createElement(p.b,{path:S.a.ROUTES.EDIT_CERT,component:ye}),o.a.createElement(p.b,{path:S.a.ROUTES.QR_REQUEST,component:le}),o.a.createElement(p.b,{path:S.a.ROUTES.DELEGATES,component:de}))),o.a.createElement("h6",{className:"Version"},"v",S.a.VERSION))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(324).config(),l.a.render(o.a.createElement(T.a,null,o.a.createElement(Me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},5:function(e,t){e.exports={LOGIN:{WELCOME:"BIENVENIDO AL EMISOR DE CERTIFICADOS WEB",BUTTONS:{ENTER:"Ingresar"}},EDIT:{DATA:{PREVIEW:"CAMPOS A PREVISUALIZAR",CATEGORIES:"CATEGORIA DEL CERTIFICADO",CERT:"DATOS DEL CERTIFICADO",PART:"DATOS DEL PARTICIPANTE",OTHER:"OTROS DATOS",MICRO_CRED_NAME:"NOMBRE DE LA MICRO",MICRO_CRED_FIELDS:"CAMPOS DE LA MICRO"},DIALOG:{QR:{REQUEST_SENT:"Pedido enviado",LOAD_BY_QR:"Cargar participante con c\xf3digo Qr",LOADED_BY_QR:function(e){return"Participante "+e+" cargado."},DIDS_TITLE:"DIDS Cargados:"},PARTICIPANT:{TITLE:"Agregar Participante",NAME:"Participante",CREATE:"Agregar",CLOSE:"Cerrar"},FIELD:{TITLE:"Agregar Campo",OPTION:"Opcion",REQUIRED:"Requerido",TYPES:"Tipo",NAME:"Nombre",CREATE:"Crear",CLOSE:"Cerrar"}},BUTTONS:{LOAD_DIDS_FROM_CSV:"Cargar Dids por CSV",ADD_MICRO_CRED_LABEL:"Agregar Micro",REMOVE_MICRO_CRED_LABEL:"Quitar Micro",ADD_MICRO_CRED:"+",REMOVE_MICRO_CRED:"-",REMOVE_PARTICIPANTS:"X",SAMPLE_PART_FROM_CSV:"Generar CSV",SAMPLE_CERT_FROM_CSV:"Generar CSV",LOAD_CERT_FROM_CSV:"Cargar con CSV",ADD_PARTICIPANTS:"Nuevo Participante",LOAD_PARTICIPANTS:"Cargar Participantes",RENAME_ISSUER:"Renombrar Emisor",CREATE:"NUEVO CAMPO",SEND:"Enviar",SAVE:"Guardar",CANCEL:"Cancelar",CLOSE:"Cerrar",BACK:"Volver",EXIT:"Salir",REQUIRED:"Requerido",DELETE:"Borrar"}},LIST:{MENU:{TITLE:"Menu"},DIALOG:{ISSUER_RENAME_TITLE:function(e){return"Renombrar emisor (El nombre actual es '"+e+"'):"},DELETE_CONFIRMATION:"Esta seguro?",DELETE_CERT_TITLE:"Borrar Certificado",DELETE_TEMPLATE_TITLE:"Borrar Modelo",DELETE_DELEGATE_TITLE:"Borrar Delegado",REVOKE_CERT_TITLE:"Revocar Certificado",REVOKE_CONFIRMATION:"Esta seguro?",REVOKE:"Revocar",DELETE:"Borrar",CREATE_DELEGATE_TITLE:"Crear Delegado",CREATE_TEMPLATE_TITLE:"Crear Modelo",DID:"Did",NAME:"Nombre",CREATE:"Crear",CANCEL:"Cancelar",CLOSE:"Cerrar"},TABLE:{DID:"DID",HAS_TEL:"TELEFONO",HAS_MAIL:"MAIL",HAS_PERSONAL:"DATOS",HAS_PERSONAL2:"PERSONALES",HAS_ADDRESS:"DOMICILIO",TEMPLATE:"MODELO DE CERTIFICADO",CERT:"CERTIFICADO",LAST_NAME:"APELLIDO",NAME:"NOMBRE",PREV:"ANTERIOR",NEXT:"SIGUIENTE",EMISSION_DATE:"FECHA DE",EMISSION_DATE2:"EMISION",SELECT:"SELECCIONAR",ACTIONS:"ACCIONES"},BUTTONS:{CREATE_DELEGATE:"CREAR DELEGADO",DELEGATES:"DELEGADOS",TO_QR:"REGISTRAR PARTICIPANTE",TO_CERTIFICATES:"CERTIFICADOS",TO_TEMPLATES:"TEMPLATES",CREATE_TEMPLATE:"CREAR MODELO DE CERTIFICADO",CREATE_CERT:"EMITIR CERTIFICADO",EMMIT_SELECTED:"Emitir Seleccionados",EMMIT:"Emitir",VIEW:"Ver",EDIT:"Editar",DELETE:"Borrar",REVOKE:"Revocar",EXIT:"Salir"}},QR:{LOAD_SUCCESS:function(e){return"USUARIO '"+e+"' CARGADO CON \xc9XITO"},DID_SELECT:"DID",CERTIFICATE_SELECT:"CERTIFICADO A PEDIR",TEMPLATE_SELECT:"MODELO DE CERTIFICADO",TEMPLATE_PART_SELECT_MESSAGE:"Elige el usuario a el que se pediran los datos:",TEMPLATE_SELECT_MESSAGE:"Elige el modelo de certificado para el que se pediran los datos:",QR_MESSAGE_CERT:"O alternativamente ecanea el qr con la aplicacion para cargar los datos:",QR_MESSAGE:"Ecanear el qr con la aplicacion para cargar los datos requeridos por el modelo de certificado:",QR_PD:"Nota: Los datos obtenidos a partir del Qr seran accessibles solo para el modelo de certificado actual",FULL_NAME:"NOMBRE COMPLETO",BUTTONS:{REQUEST:"Pedir certificados",QR_LOAD:"Cargar por Qr",GENERATE:"Generar Qr"}}}}},[[171,1,2]]]);
//# sourceMappingURL=main.6fed498f.chunk.js.map